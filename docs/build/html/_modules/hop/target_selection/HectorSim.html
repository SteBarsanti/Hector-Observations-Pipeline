<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>hop.target_selection.HectorSim &#8212; Hector Observations Pipeline 1.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          Hector Observations Pipeline</a>
        <span class="navbar-text navbar-version pull-left"><b></b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../calculating_offsets.html">Calculating Offsets from one Hexabundle to another</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot_plate_configuration.html">Plotting a plate configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../show_sky_fibre_changes_between_plates.html">Showing the Sky Fibre Changes between Plates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../check_magnet_counts_between_tiles.html">Checking two plates can be observed after each other</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Table of Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../calculating_offsets.html">Calculating Offsets from one Hexabundle to another</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../plot_plate_configuration.html">Plotting a plate configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../show_sky_fibre_changes_between_plates.html">Showing the Sky Fibre Changes between Plates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../check_magnet_counts_between_tiles.html">Checking two plates can be observed after each other</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../prepare_files_for_robot.html">Preparing files to be configured by the robot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../api.html">API</a></li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
              
                
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for hop.target_selection.HectorSim</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">yaml</span>
<span class="kn">import</span> <span class="nn">bisect</span>
<span class="c1"># For reading fits tables</span>
<span class="kn">from</span> <span class="nn">..misc</span> <span class="kn">import</span> <span class="n">pandas_tools</span> <span class="k">as</span> <span class="n">P</span> 
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">..misc</span> <span class="kn">import</span> <span class="n">misc_tools</span> <span class="k">as</span> <span class="n">misc</span>

<span class="c1"># def _load_config(SourceCat):</span>

<span class="c1">#     with open(f&quot;Config/{SourceCat}.yml&quot;, &#39;r&#39;) as ymlfile:</span>
<span class="c1">#         config = yaml.safe_load(ymlfile)</span>

<span class="c1">#     return config</span>


<span class="c1"># def _read_table(fname):</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     Read in a table, either with fits or pandas</span>
<span class="c1">#     &quot;&quot;&quot;</span>
<span class="c1">#     # Read in the whole table. May be an issue with massive tables?</span>
<span class="c1">#     extension = fname.split(&#39;.&#39;)[-1]</span>
<span class="c1">#     if extension == &#39;csv&#39;:</span>
<span class="c1">#         table = pd.read_csv(fname)</span>
<span class="c1">#     elif extension == &#39;tsv&#39;:</span>
<span class="c1">#         table = pd.read_csv(fname, sep=&#39;\t&#39;)</span>
<span class="c1">#     elif extension == &#39;fits&#39;:</span>
<span class="c1">#         table = P.load_FITS_table_in_pandas(fname)</span>
<span class="c1">#         #raise TypeError(&quot;Not yet written the code for fits... Exiting!&quot;)</span>
<span class="c1">#     else:</span>
<span class="c1">#         raise TypeError(f&quot;Catalogue {fname} data type \</span>
<span class="c1">#             not understood&quot;)</span>
<span class="c1">#     return table</span>


<div class="viewcode-block" id="load_table"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.load_table">[docs]</a><span class="k">def</span> <span class="nf">load_table</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Read in the table, apply the selection cuts and make our cut-down table</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">table</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">_read_table</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;input_master_catalogue_filename&#39;</span><span class="p">])</span>

    <span class="n">selection</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s1">&#39;selection&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected rows with: </span><span class="si">{</span><span class="n">selection</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="c1"># Cut down our table based on the python code in the config file</span>
    <span class="n">reduced_table</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="nb">eval</span><span class="p">(</span><span class="n">selection</span><span class="p">)]</span>

    <span class="c1"># Get the names of each column we want and their index in this</span>
    <span class="c1"># specific table</span>
    <span class="n">column_names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Columns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()))</span>
    <span class="n">column_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;Columns&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">()))</span>

    <span class="c1"># Find the columns we want which exist in this table- i.e. those which</span>
    <span class="c1"># have an index which isn&#39;t &quot;None&quot;</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">column_indices</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">):</span>
        <span class="n">not_none_mask</span> <span class="o">=</span> <span class="n">column_indices</span> <span class="o">!=</span> <span class="s1">&#39;None&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">not_none_mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">column_indices</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>

    <span class="c1"># Columns which we&#39;ll select from the table</span>
    <span class="n">columns_to_select</span> <span class="o">=</span> <span class="n">column_indices</span><span class="p">[</span><span class="n">not_none_mask</span><span class="p">]</span>
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">columns_to_select</span><span class="p">)</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="n">columns_to_select</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> \
        <span class="s1">&#39;Looks like we have a repeated index in the config file&#39;</span>

    <span class="c1"># ...and the names we&#39;ll rename them</span>
    <span class="n">column_names_for_renaming</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[</span><span class="n">not_none_mask</span><span class="p">]</span>

    <span class="c1"># final table- select our columns</span>
    <span class="n">final_table</span> <span class="o">=</span> <span class="n">reduced_table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="n">columns_to_select</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)]</span>

    <span class="c1"># Rename the columns- this is a dictionary of old_name : new_name</span>
    <span class="n">renamed_columns</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">final_table</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span>
                               <span class="n">column_names_for_renaming</span><span class="p">))</span>

    <span class="n">final_table</span> <span class="o">=</span> <span class="n">final_table</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">renamed_columns</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Renaming Columns:&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">old_name</span><span class="p">,</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="n">renamed_columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2"> </span><span class="si">{</span><span class="n">old_name</span><span class="si">}</span><span class="s2"> --&gt; </span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># Check everything which should be a float actually is</span>
            <span class="k">if</span> <span class="n">new_name</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;Mstar&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="s1">&#39;Re&#39;</span><span class="p">,</span> <span class="s1">&#39;GAL_MAG_R&#39;</span><span class="p">,</span> <span class="s1">&#39;GAL_MAG_I&#39;</span><span class="p">]:</span>
                <span class="n">final_table</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">to_numeric</span><span class="p">(</span>
                    <span class="n">final_table</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">new_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">],</span> <span class="n">errors</span><span class="o">=</span><span class="s1">&#39;coerce&#39;</span><span class="p">)</span>

    <span class="c1"># Now add in the columns which didn&#39;t exist in the table as nans</span>
    <span class="n">none_values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">column_indices</span> <span class="o">==</span> <span class="s1">&#39;None&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">none_values</span><span class="p">:</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="n">column_names</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="n">final_table</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">final_table</span></div>



<div class="viewcode-block" id="sparse_select_flat_in_Mass"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.sparse_select_flat_in_Mass">[docs]</a><span class="k">def</span> <span class="nf">sparse_select_flat_in_Mass</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">MStarSparseCutBin</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Take a table of stellar masses and bin into 5 bins between MstarMin and</span>
<span class="sd">    MstarMax.</span>
<span class="sd">    Take the number in the MSparseCut1 bin (call it n) and then flatten all</span>
<span class="sd">    bins to have at most n galaxies in</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Get the bin which each value should be in</span>
    <span class="n">bin_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">digitize</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
    <span class="n">numMstar</span><span class="p">,</span> <span class="n">edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">table</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

    <span class="n">Num_per_Mstarbin</span> <span class="o">=</span> <span class="n">numMstar</span><span class="p">[</span><span class="n">MStarSparseCutBin</span><span class="p">]</span>

    <span class="c1"># Now loop through each bin and select which bin members to keep</span>
    <span class="c1"># import ipdb; ipdb.set_trace()</span>
    <span class="c1"># indices_to_keep = []</span>
    <span class="c1"># for bin_num in np.unique(bin_indices):</span>
    <span class="c1">#     indices_in_bin = np.where(bin_indices == bin_num)[0]</span>
    <span class="c1">#     N_in_bin = indices_in_bin.size</span>
    <span class="c1">#     if N_in_bin &lt;= Num_per_Mstarbin:</span>
    <span class="c1">#         indices_to_keep += (indices_in_bin.tolist())</span>
    <span class="c1">#     else:</span>
    <span class="c1">#         random_choice = np.random.choice(indices_in_bin, Num_per_Mstarbin, replace=False)</span>
    <span class="c1">#         indices_to_keep += random_choice.tolist()</span>

    <span class="n">indices_to_keep</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">bin_num</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">bin_indices</span><span class="p">):</span>
        <span class="n">indices_in_bin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">bin_indices</span> <span class="o">==</span> <span class="n">bin_num</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">N_in_bin</span> <span class="o">=</span> <span class="n">indices_in_bin</span><span class="o">.</span><span class="n">size</span>
        <span class="k">if</span> <span class="n">bin_num</span> <span class="o">&lt;=</span> <span class="n">MStarSparseCutBin</span><span class="p">:</span>
            <span class="n">indices_to_keep</span> <span class="o">+=</span> <span class="p">(</span><span class="n">indices_in_bin</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">N_in_bin</span> <span class="o">&lt;=</span> <span class="n">Num_per_Mstarbin</span><span class="p">:</span>
                <span class="n">indices_to_keep</span> <span class="o">+=</span> <span class="p">(</span><span class="n">indices_in_bin</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">random_choice</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">indices_in_bin</span><span class="p">,</span> <span class="n">Num_per_Mstarbin</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">indices_to_keep</span> <span class="o">+=</span> <span class="n">random_choice</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

    <span class="n">indices_to_keep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices_to_keep</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">table</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">indices_to_keep</span><span class="p">,</span> <span class="p">:]</span></div>


<div class="viewcode-block" id="safe_div"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.safe_div">[docs]</a><span class="k">def</span> <span class="nf">safe_div</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">y</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span></div>


<div class="viewcode-block" id="add_boxes_to_Mstar_z"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.add_boxes_to_Mstar_z">[docs]</a><span class="k">def</span> <span class="nf">add_boxes_to_Mstar_z</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">table_data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Taken from original code, lines 1169 to 1204</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">zdivisions</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
    <span class="n">Mstardivisions</span> <span class="o">=</span> <span class="p">(</span><span class="mf">9.0</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
    <span class="n">Frac_Re_Cut</span> <span class="o">=</span> <span class="mf">2.0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]:</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">zdivisions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">zdivisions</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="n">Mstardivisions</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">Mstardivisions</span><span class="p">[</span><span class="n">j</span><span class="p">]],</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
            <span class="c1"># ax.plot([zdivisions[i],zdivisions[i] ], [pz_max(zdivisions[i]),12], &#39;-.&#39;, color=&#39;black&#39;)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">zdivisions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">zdivisions</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span> <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;-.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
            <span class="c1"># plt.plot([0.0,0.02 ], [9.0,9.0], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.0,0.04 ], [9.4,9.4], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.0,0.1 ], [10.3,10.3], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.0,0.1 ], [10.9,10.9], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.02,0.02 ], [pz_max(0.02),12], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.04,0.04 ], [pz_max(0.04),12], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.06,0.06 ], [pz_max(0.06),12], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.08,0.08 ], [pz_max(0.08),12], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="c1"># plt.plot([0.1,0.1 ], [pz_max(0.1),12], &#39;.&#39;, color=&#39;black&#39;)</span>
            <span class="n">Num_per_boxarray</span> <span class="o">=</span> <span class="n">table_data</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="o">.</span><span class="n">reduce</span><span class="p">((</span><span class="n">table_data</span><span class="o">.</span><span class="n">z</span> <span class="o">&gt;</span> <span class="n">zdivisions</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">table_data</span><span class="o">.</span><span class="n">z</span> <span class="o">&lt;</span> <span class="n">zdivisions</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)],</span> <span class="n">table_data</span><span class="o">.</span><span class="n">Mstar</span> <span class="o">&gt;</span> <span class="n">Mstardivisions</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">table_data</span><span class="o">.</span><span class="n">Mstar</span> <span class="o">&lt;</span> <span class="n">Mstardivisions</span><span class="p">[(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]))]</span>
            <span class="c1"># print &#39;Num_per_boxarray[:,Re_col]&#39;, Num_per_boxarray[:,Re_col]</span>
            <span class="c1"># print &#39;np.shape(Num_per_boxarray)&#39;, np.shape(Num_per_boxarray)</span>
            <span class="c1"># print &#39;np.shape(Num_per_boxarray[:,Re_col])&#39;, np.shape(Num_per_boxarray[:,Re_col])</span>
            <span class="n">Num_per_boxtemp</span> <span class="o">=</span> <span class="n">Num_per_boxarray</span><span class="o">.</span><span class="n">Re</span>
            <span class="n">Num_per_box</span> <span class="o">=</span> <span class="n">Num_per_boxtemp</span><span class="o">.</span><span class="n">size</span>
            <span class="c1"># Num_per_box =Num_per_boxtemp[0]</span>
            <span class="c1"># print &#39;Num_per_boxtemp, Num_per_box, Num_per_box[0]&#39;, Num_per_boxtemp, Num_per_box, Num_per_box[0]</span>
            <span class="n">Num_per_box_reGT1pt5</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">Num_per_boxtemp</span><span class="p">[(</span><span class="n">Num_per_boxtemp</span> <span class="o">&gt;</span> <span class="n">Frac_Re_Cut</span><span class="p">)])</span>  <span class="c1"># Not sure why this is two and not our cut from the command line?</span>

            <span class="c1"># print &#39;Num_per_boxtemp[(Num_per_boxtemp&gt;Frac_Re_Cut)]&#39;,Num_per_boxtemp[(Num_per_boxtemp&gt;Frac_Re_Cut)]</span>
            <span class="c1"># print &#39;Num_per_box_reGT1pt5&#39;, Num_per_box_reGT1pt5</span>
            <span class="n">FracGTRe1pt5</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="p">(</span><span class="n">safe_div</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">Num_per_box_reGT1pt5</span><span class="p">[</span><span class="mi">0</span><span class="p">])),</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Num_per_box</span><span class="p">)))))</span>
            <span class="c1"># print &#39;Num_per_boxarray, Num_per_box[0], Num_per_box_reGT1pt5[0],FracGTRe1pt5&#39;, Num_per_boxarray, Num_per_box[0], Num_per_box_reGT1pt5[0],FracGTRe1pt5</span>
            <span class="c1"># print &#39;(zdivisions[(i+1)]+zdivisions[(i)])/2., (Mstardivisions[(j+1)]+Mstardivisions[(j)])/2.&#39;, (zdivisions[(i+1)]+zdivisions[(i)])/2., (Mstardivisions[(j+1)]+Mstardivisions[(j)])/2.</span>
            <span class="n">zboxcentre</span> <span class="o">=</span> <span class="p">((</span><span class="n">zdivisions</span><span class="p">[(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">zdivisions</span><span class="p">[(</span><span class="n">i</span><span class="p">)])</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
            <span class="n">Mboxcentre</span> <span class="o">=</span> <span class="p">((</span><span class="n">Mstardivisions</span><span class="p">[(</span><span class="n">j</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">+</span> <span class="n">Mstardivisions</span><span class="p">[(</span><span class="n">j</span><span class="p">)])</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">zboxcentre</span><span class="p">,</span> <span class="n">Mboxcentre</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">FracGTRe1pt5</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">verticalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>


<div class="viewcode-block" id="calculate_SB_at_R"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.calculate_SB_at_R">[docs]</a><span class="k">def</span> <span class="nf">calculate_SB_at_R</span><span class="p">(</span><span class="n">Sersic_index</span><span class="p">,</span> <span class="n">Mu_e</span><span class="p">,</span> <span class="n">multiple_of_Re</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Calculate a galaxy&#39;s surface brightness at a given multiple of Re from its surface brightness at Re</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Sersic indices</span>
    <span class="n">n_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span>
    <span class="c1"># Values of b from the Sersic Formula</span>
    <span class="n">bvalue_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.6783470</span><span class="p">,</span> <span class="mf">3.6720608</span><span class="p">,</span> <span class="mf">5.6701554</span><span class="p">,</span> <span class="mf">7.6692495</span><span class="p">,</span> <span class="mf">9.6687149</span><span class="p">,</span> <span class="mf">11.668363</span><span class="p">,</span> <span class="mf">13.667757</span><span class="p">,</span> 
        <span class="mf">15.667704</span><span class="p">,</span> <span class="mf">17.667636</span><span class="p">,</span> <span class="mf">19.667567</span><span class="p">])</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">Sersic_index</span><span class="p">,</span> <span class="n">n_table</span><span class="p">,</span> <span class="n">bvalue_table</span><span class="p">)</span>

    <span class="c1"># Equation from https://ned.ipac.caltech.edu/level5/March05/Graham/Graham2.html</span>
    <span class="n">SB_at_R</span> <span class="o">=</span> <span class="n">Mu_e</span> <span class="o">+</span> <span class="mf">2.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span> <span class="o">*</span> <span class="p">((</span><span class="n">multiple_of_Re</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">Sersic_index</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">SB_at_R</span></div>


<div class="viewcode-block" id="HectorSim"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim">[docs]</a><span class="k">class</span> <span class="nc">HectorSim</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class to simulate obsverations for Hector. </span>

<span class="sd">    We load in a catalogue, select the columns we want, then make plots with (in general) three samples:</span>
<span class="sd">        * all objects above some limiting surface brightness (plotted in RED)</span>
<span class="sd">        * all objects given some selection function in mass  (plotted in BLUE)</span>
<span class="sd">        * a subsample of the blue objects, given some sampling technique (plotted in MAGENTA)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entire_table</span><span class="p">,</span> <span class="n">BoundaryType</span><span class="p">,</span> <span class="n">zlimit</span><span class="p">,</span> <span class="n">MstarMin</span><span class="p">,</span> <span class="n">MstarMax</span><span class="p">,</span> <span class="n">SparseFunction</span><span class="p">,</span> <span class="n">SourceCat</span><span class="p">,</span> <span class="n">MSparseCut1</span><span class="p">,</span> <span class="n">minRe</span><span class="p">,</span> <span class="n">total_area</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">Dec_Min</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">Dec_Max</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            BoundaryType (str): This controls both the type of selection done in stellar mass and the limiting surface brightness of the sample. Must be one of &quot;Taipan&quot; or &quot;SAMI&quot; (case insensitive). </span>

<span class="sd">            zlimit (float): The maximum z to which we select galaxies. All objects at z &gt; zlimit will be ignored in our BLUE and MAGENTA samples.</span>

<span class="sd">            MstarMin (float): Used to set the leftmost edge of the smallest mass bin in the mass histograms. </span>

<span class="sd">            MstarMax (float): Used to set the rightmost edge of the largest mass bin in the mass histograms. </span>

<span class="sd">            SparseFunction (int): Method to go from our BLUE sample to our MAGENTA sample. Must be 1 or 2. Method 1 selects MAGENTA galaxies using the following method- all galaxies below MSparseCut1 are selected. For galaxies above MSparseCut1, we take a random sample in mass such that each bin contains the same number of galaxies as in the MSparseCut1 bin. Method 2 is the same as method 1 except we upweight star-forming objects (those on the blue cloud in colour-magnitude space). </span>

<span class="sd">            SourceCat (str): Name of the input catalogue to use. Must have a file names &lt;SourceCat&gt;.yml in the Config/ directory, which we will use to read in the catalogue. </span>

<span class="sd">            MSparseCut1 (float): The bin at which we start our sparse sampling to flatten off the mass distribution. </span>

<span class="sd">            minRe (float): A cut applied on the Re of targets. Can be 0.0 to not select on Re</span>

<span class="sd">            quiet (bool, optional): Suppress print statements. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Some checking on the Boundary Type</span>
        <span class="k">if</span> <span class="n">BoundaryType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;taipan&#39;</span><span class="p">,</span> <span class="s2">&quot;Taipan&quot;</span><span class="p">,</span> <span class="s2">&quot;TAIPAN&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span> <span class="o">=</span> <span class="s2">&quot;Taipan&quot;</span>
        <span class="k">elif</span> <span class="n">BoundaryType</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;sami&#39;</span><span class="p">,</span> <span class="s2">&quot;Sami&quot;</span><span class="p">,</span> <span class="s2">&quot;SAMI&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span> <span class="o">=</span> <span class="s2">&quot;SAMI&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">BoundaryType</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span> <span class="o">=</span> <span class="s1">&#39;General&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryFile</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">BoundaryType</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Bounday Type </span><span class="si">{</span><span class="n">BoundaryType</span><span class="si">}</span><span class="s2"> not understood or file does not exist&quot;</span><span class="p">)</span>

        <span class="c1"># Save our input parameters as class attributes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zlimit</span> <span class="o">=</span> <span class="n">zlimit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MstarMin</span> <span class="o">=</span> <span class="n">MstarMin</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MstarMax</span> <span class="o">=</span> <span class="n">MstarMax</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SparseFunction</span> <span class="o">=</span> <span class="n">SparseFunction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MSparseCut1</span> <span class="o">=</span> <span class="n">MSparseCut1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">minRe</span> <span class="o">=</span> <span class="n">minRe</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SourceCat</span> <span class="o">=</span> <span class="n">SourceCat</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">quiet</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span> <span class="o">=</span> <span class="n">entire_table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_area</span> <span class="o">=</span> <span class="n">total_area</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span> 
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum redshift is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">zlimit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source Catalogue is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">SourceCat</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Boundary Type is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sparse Function is type </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">SparseFunction</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;MSparse Cut is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MSparseCut1</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mstar is between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MstarMin</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">MstarMax</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selecting objects with Re greater than </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">minRe</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># Check if we have HI information and update an HI_info attribute if we do</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HI_info</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;WALLABYflag&#39;</span><span class="p">]))</span> <span class="ow">or</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;Dingoflag&#39;</span><span class="p">])):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HI_info</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Colourmap for plotting. Should add this as an option...</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cm</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">)</span>

        <span class="c1"># Make a mask to get rid of obviously silly numbers</span>
        <span class="c1"># We&#39;ll add a check on the surface brightness values too later if we can create them</span>
        <span class="n">good_data_mask</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Mstar</span> <span class="o">&gt;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Mstar</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">MstarMax</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Re</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Re</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">)</span>
        <span class="c1"># Add in columns we&#39;ll need, such as g-i colour and the IFU diameter to get to 2Re</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;g_m_i&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;GAL_MAG_G&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;GAL_MAG_I&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;IFU_diam_2Re&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Re&#39;</span><span class="p">]</span>

        <span class="c1"># Work out surface brightness at 2 and 3 Re if we can</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">))</span> <span class="o">|</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">SersicIndex_r</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_2Re&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_SB_at_R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">SersicIndex_r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_3Re&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">calculate_SB_at_R</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">SersicIndex_r</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
            <span class="n">good_data_mask</span> <span class="o">=</span> <span class="n">good_data_mask</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_2Re&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">40.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_2Re&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_3Re&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mf">40.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_3Re&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_2Re&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;GAL_MU_R_at_3Re&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>


       
        <span class="c1"># This is our entire table, which we&#39;ll now select our samples from</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">good_data_mask</span><span class="p">]</span>

        <span class="c1"># Check how many rows our &#39;entire table&#39; has</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Looks like our table doesn&#39;t have any rows after getting rid of bad values of M and R_e&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">After getting rid of unphysical values, the master table has </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows&quot;</span><span class="p">)</span>



        <span class="c1"># Get our various limits and cuts limits</span>
        <span class="c1"># Mag_mask is a boolean True/False which selects all galaxies brighter than this cut</span>
        <span class="c1"># Mstar_cut_pz is a boolean True/False which selects galaxies above pz(z) curve</span>
        <span class="c1"># Mstar_cut_qz is a boolean True/False which selects galaxies above qz(z) curve</span>
        <span class="c1"># Z_mask is a boolean True/False which selects galaxies less than our maximum z</span>
        <span class="c1"># Min_Re cut is a boolean True/False which selects galaxies larger than the minimum Re</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span> <span class="o">==</span> <span class="s1">&#39;SAMI&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span> <span class="o">=</span> <span class="mf">19.8</span>
            <span class="n">maglimit</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;r&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MAG_R</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span> <span class="o">==</span> <span class="s1">&#39;Taipan&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span> <span class="o">=</span> <span class="mf">17.0</span>
            <span class="n">maglimit</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;i&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MAG_I</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span> <span class="o">==</span> <span class="s1">&#39;General&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span> <span class="o">=</span> <span class="mf">19.8</span>
            <span class="n">maglimit</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;r&lt;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span><span class="si">}</span><span class="s1">&#39;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MAG_R</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maglimitcut</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_load_selection_function_from_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryFile</span><span class="p">)</span>

        <span class="c1"># And now select a strip in Dec, if we want to</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">([</span><span class="n">Dec_Min</span><span class="p">,</span> <span class="n">Dec_Max</span><span class="p">])):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dec_Min</span> <span class="o">=</span> <span class="n">Dec_Min</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dec_Max</span> <span class="o">=</span> <span class="n">Dec_Max</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Dec_mask</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">DEC</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dec_Min</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">DEC</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dec_Max</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selecting a strip in DEC between </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Dec_Min</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">Dec_Max</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">In this stripe, we have </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Dec_mask</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2"> rows</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Magnitude Limit: </span><span class="si">{</span><span class="n">maglimit</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="c1"># These are curves/lines in the M*/Z plane which tell us which galaxies to select</span>
        <span class="c1"># the Taipain selection is a smooth curve, SAMI is a series of steps</span>
        <span class="n">qz</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_qz_pz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mstar_cut_pz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Mstar</span> <span class="o">&gt;</span> <span class="n">pz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Mstar_cut_qz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Mstar</span> <span class="o">&gt;</span> <span class="n">qz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">zcut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zlimit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Re_cut</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Re</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">minRe</span>

        <span class="c1"># Now we select down our samples</span>
        <span class="c1"># We&#39;ll have one greater than the qz(z) curve, brighter than the mag limit and z&lt;0.1. This is self.possible_to_observe and will be plotted in RED</span>
        <span class="c1"># One greater than the pz(z) curve, brighter than the mag limit and less than 0.1. This is self.selection_function and will be plotted in BLUE</span>
        <span class="c1"># And one the same as above but sparsely sampled. This is self.selection_function_sparsely_sampled and is plotted in MAGENTA</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">([</span><span class="n">Dec_Min</span><span class="p">,</span> <span class="n">Dec_Max</span><span class="p">])):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Mstar_cut_qz</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcut</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Re_cut</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dec_mask</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Mstar_cut_pz</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcut</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Re_cut</span><span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Dec_mask</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Mstar_cut_qz</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcut</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Re_cut</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">Mstar_cut_pz</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">zcut</span> <span class="o">&amp;</span> <span class="bp">self</span><span class="o">.</span><span class="n">Re_cut</span><span class="p">]</span>

        <span class="n">nbins</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">MstarMax</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">MstarMin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">5.</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MstarMin</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MstarMax</span><span class="p">,</span> <span class="n">nbins</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">MStarSparseCutBin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">MSparseCut1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">MstarMin</span><span class="p">)</span> <span class="o">*</span> <span class="mi">5</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span> <span class="o">=</span> <span class="n">sparse_select_flat_in_Mass</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_bins</span><span class="p">,</span> <span class="n">MStarSparseCutBin</span><span class="p">)</span>


<div class="viewcode-block" id="HectorSim.qz_function"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.qz_function">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">qz_function</span><span class="p">():</span>

        <span class="n">SAMIsel2_points_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span>
        <span class="n">SAMIsel2_points_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.0</span><span class="p">,</span> <span class="mf">9.7</span><span class="p">,</span> <span class="mf">9.7</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="mf">9.7</span><span class="p">,</span> <span class="mf">7.0</span><span class="p">])</span>
        <span class="c1"># SAMIsel2_points_x = np.array([0,0.15])</span>
        <span class="c1"># SAMIsel2_points_y = np.array([9.0,10.0])</span>
        <span class="n">qz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">SAMIsel2_points_x</span><span class="p">,</span> <span class="n">SAMIsel2_points_y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">qz</span></div>

<div class="viewcode-block" id="HectorSim.Taipan_Selection"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.Taipan_Selection">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">Taipan_Selection</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Taipan Selection cut. Lines 760-765</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Now do a selection that follows roughly the apparent stellar mass</span>
        <span class="c1"># completeness in the xVSMstar_SAMI_HI_iLT17.pdf TAIPAN selection -</span>
        <span class="c1"># which is GAMA with i&lt;17 cut (maglimitcut value).</span>
        <span class="n">SAMIsel_points_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.004</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.04</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.08</span><span class="p">,</span>
                                     <span class="mf">0.09</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.11</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mf">0.14</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">])</span>
        <span class="n">SAMIsel_points_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.4</span><span class="p">,</span> <span class="mf">8.9</span><span class="p">,</span> <span class="mf">9.6</span><span class="p">,</span> <span class="mf">9.7</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">10.1</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span>
                                     <span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.2</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">,</span> <span class="mf">10.6</span><span class="p">,</span> <span class="mf">10.8</span><span class="p">])</span>

        <span class="n">pz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">poly1d</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">polyfit</span><span class="p">(</span><span class="n">SAMIsel_points_x</span><span class="p">,</span> <span class="n">SAMIsel_points_y</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">pz</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_load_selection_function_from_file</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>

        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">filename</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ymlfile</span><span class="p">:</span>
            <span class="n">selection_function</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">ymlfile</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">selection_function</span>

<div class="viewcode-block" id="HectorSim.general_selection"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.general_selection">[docs]</a>    <span class="k">def</span> <span class="nf">general_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">z</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_lim&#39;</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_gradient&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_constant_offset&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_lim&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_2&#39;</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_2&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_2&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_3&#39;</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_3&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_3&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_4&#39;</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_4&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_4&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_5&#39;</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_5&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_5&#39;</span><span class="p">]):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;final_mass_step&#39;</span><span class="p">]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
            <span class="n">y</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_lim&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_gradient&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_lim&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_constant_offset&#39;</span><span class="p">]</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;lower_lim&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_2&#39;</span><span class="p">])]</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_2&#39;</span><span class="p">]</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_2&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_3&#39;</span><span class="p">])]</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_3&#39;</span><span class="p">]</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_3&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_4&#39;</span><span class="p">])]</span> <span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_4&#39;</span><span class="p">]</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_4&#39;</span><span class="p">])</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">z</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_5&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;mass_step_5&#39;</span><span class="p">]</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">z</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;limit_5&#39;</span><span class="p">])]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sf_config</span><span class="p">[</span><span class="s1">&#39;final_mass_step&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">y</span></div>

<div class="viewcode-block" id="HectorSim.sami_stepfunc"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.sami_stepfunc">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">sami_stepfunc</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the SAMI steps. Vectorised version of Lines 786-823.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">62.5</span> <span class="o">*</span> <span class="n">a</span> <span class="o">+</span> <span class="mf">6.95</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.02</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.03</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">8.2</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.03</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.045</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">8.6</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.045</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.06</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">9.4</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.06</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.095</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">10.3</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.095</span><span class="p">):</span>
                <span class="n">y</span> <span class="o">=</span> <span class="mf">10.9</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
            <span class="n">y</span><span class="p">[</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">]</span> <span class="o">=</span> <span class="mf">62.5</span> <span class="o">*</span> <span class="n">a</span><span class="p">[</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.02</span><span class="p">]</span> <span class="o">+</span> <span class="mf">6.95</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.02</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.03</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">8.2</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.03</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.045</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">8.6</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.045</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.06</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">9.4</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.06</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mf">0.095</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">10.3</span>
            <span class="n">y</span><span class="p">[(</span><span class="n">a</span> <span class="o">&gt;=</span> <span class="mf">0.095</span><span class="p">)]</span> <span class="o">=</span> <span class="mf">10.9</span>

        <span class="k">return</span> <span class="n">y</span></div>

<div class="viewcode-block" id="HectorSim.get_qz_pz"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.get_qz_pz">[docs]</a>    <span class="k">def</span> <span class="nf">get_qz_pz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">BoundaryType</span><span class="p">):</span>

        <span class="n">qz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qz_function</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">BoundaryType</span> <span class="o">==</span> <span class="s2">&quot;Taipan&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">qz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">Taipan_Selection</span>
        <span class="k">elif</span> <span class="n">BoundaryType</span> <span class="o">==</span> <span class="s2">&quot;SAMI&quot;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">qz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sami_stepfunc</span>
        <span class="k">elif</span> <span class="n">BoundaryType</span> <span class="o">==</span> <span class="s1">&#39;General&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">qz</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">general_selection</span></div>


        <span class="c1"># TODO: Add in sparse selection method 2</span>

<div class="viewcode-block" id="HectorSim.plot_parent_sample"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_parent_sample">[docs]</a>    <span class="k">def</span> <span class="nf">plot_parent_sample</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a plot of the parent sample in M*-z coordinates</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># Linewidths and sizes of each point</span>
        <span class="n">lw</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">s</span> <span class="o">=</span> <span class="mi">1</span>

        <span class="c1"># Check if we have surface brightness info</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">)):</span>

            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Mstar_z_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> 
                <span class="n">colour_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s2">&quot;Surface Brightness&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">24</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Mstar_z_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">)</span>

        <span class="c1"># Outline each point in black if we think it has HI. </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">HI_info</span><span class="p">:</span>
            <span class="n">HI_mask</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">WALLABYflag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Dingoflag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">HI_mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Mstar</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">HI_mask</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">edgecolors</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.10</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="s2">&quot;black=HI&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="s2">&quot;Parent sample&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_Mstar_z_gi_colour"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_Mstar_z_gi_colour">[docs]</a>    <span class="k">def</span> <span class="nf">plot_Mstar_z_gi_colour</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a plot of M* vs z and colour by G-I colour</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">GAL_MAG_I</span><span class="p">)):</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Mstar_z_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">colour_by</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">[</span><span class="s1">&#39;g_m_i&#39;</span><span class="p">],</span> <span class="n">cbar_label</span><span class="o">=</span><span class="s1">&#39;g - i colour&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Mstar_z_plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.005</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">,</span> <span class="s2">&quot;No I-band magnitude&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

    <span class="k">def</span> <span class="nf">_Mstar_z_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">colour_by</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">cbar_label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>

        <span class="c1"># FIXME Add in H1 </span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot the stellar mass against redshift for the catalogue</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="c1"># Check if we have surfave brightnesses and colour by them if we do</span>
        <span class="k">if</span> <span class="n">colour_by</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> 
                <span class="n">y</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span>
                <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
                <span class="n">y</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">Mstar</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
                <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> 
                <span class="n">y</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> 
                <span class="n">c</span><span class="o">=</span><span class="n">colour_by</span><span class="p">,</span> 
                <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

            <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
                <span class="n">x</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
                <span class="n">y</span><span class="o">=</span><span class="n">table</span><span class="o">.</span><span class="n">Mstar</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
                <span class="n">c</span><span class="o">=</span><span class="n">colour_by</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
                <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">s</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbar_label</span><span class="p">)</span>

        <span class="n">qz</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_qz_pz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pz</span><span class="p">(</span><span class="n">xp</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="c1"># plt.plot(xp, pz(xp), &#39;-&#39;, color=&#39;orange&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">qz</span><span class="p">(</span><span class="n">xp</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mstar&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<div class="viewcode-block" id="HectorSim.plot_z_Re"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_z_Re">[docs]</a>    <span class="k">def</span> <span class="nf">plot_z_Re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span>
            <span class="n">x</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">z</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
            <span class="n">y</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Re</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
            <span class="n">c</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">g_m_i</span><span class="p">)[</span><span class="bp">self</span><span class="o">.</span><span class="n">mag_mask</span><span class="p">],</span> 
            <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="s1">&#39;g-i colour&#39;</span><span class="p">)</span>

        <span class="c1"># plt.plot(xp, pz(xp), &#39;-&#39;, color=&#39;blue&#39;)</span>
        <span class="c1"># plt.plot(xp, pz(xp), &#39;-&#39;, color=&#39;orange&#39;)</span>
        <span class="c1"># plt.plot(xp, qz(xp), &#39;-&#39;, color=&#39;red&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Re&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_selected_sample_MZ"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_selected_sample_MZ">[docs]</a>    <span class="k">def</span> <span class="nf">plot_selected_sample_MZ</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make another M*-Z plot, but this time mark on each sample. This is going to be a new function which doesn&#39;t reusue _plot_M_z- I can&#39;t see an easy way to do what I want with that function without changing everything!</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">7</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">HI_info</span><span class="p">:</span>
            <span class="n">HI_mask</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">WALLABYflag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">Dingoflag</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">HI_mask</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">Mstar</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">HI_mask</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.45</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s2">&quot;Black: Magenta sample</span><span class="se">\n</span><span class="s2">with HI&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=0.1&#39;</span><span class="p">))</span>

        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="n">qz</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_qz_pz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pz</span><span class="p">(</span><span class="n">xp</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="c1"># plt.plot(xp, pz(xp), &#39;-&#39;, color=&#39;orange&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">qz</span><span class="p">(</span><span class="n">xp</span><span class="p">),</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mstar&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s2">&quot;Selected samples&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_selected_sample_MZ_colour_Re"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_selected_sample_MZ_colour_Re">[docs]</a>    <span class="k">def</span> <span class="nf">plot_selected_sample_MZ_colour_Re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">cmap_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">Re</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="o">**</span><span class="n">cmap_kwargs</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">Re</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="o">**</span><span class="n">cmap_kwargs</span><span class="p">)</span>
        <span class="n">sc</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">Mstar</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">Re</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">linewidths</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">cmap_kwargs</span><span class="p">)</span>

        <span class="n">cbar</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">sc</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

        <span class="n">Frac_Re_Cut</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c1"># Hardcoded number? Line 1171 in Original code</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Re (% Re&gt;</span><span class="si">{</span><span class="n">Frac_Re_Cut</span><span class="si">}</span><span class="s1"> in black boxes&#39;</span><span class="p">)</span>

        <span class="c1"># Add the lines</span>
        <span class="n">qz</span><span class="p">,</span> <span class="n">pz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_qz_pz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BoundaryType</span><span class="p">)</span>
        <span class="n">xp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

        <span class="c1"># Not sure why +0.05 here?</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">,</span> <span class="n">pz</span><span class="p">(</span><span class="n">xp</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">[</span><span class="n">xp</span> <span class="o">&lt;=</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">pz</span><span class="p">(</span><span class="n">xp</span><span class="p">)[</span><span class="n">xp</span> <span class="o">&lt;=</span> <span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xp</span><span class="p">[</span><span class="n">xp</span> <span class="o">&lt;=</span> <span class="mf">0.1</span><span class="p">],</span> <span class="n">qz</span><span class="p">(</span><span class="n">xp</span><span class="p">)[</span><span class="n">xp</span> <span class="o">&lt;=</span> <span class="mf">0.1</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="n">pz</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.1005</span><span class="p">,</span> <span class="mf">0.1005</span><span class="p">],</span> <span class="p">[</span><span class="n">qz</span><span class="p">(</span><span class="mf">0.1</span><span class="p">),</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">zlimit</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">zlimit</span><span class="p">],</span> <span class="p">[</span><span class="n">pz</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">zlimit</span><span class="p">),</span> <span class="mi">12</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.045</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.6</span><span class="p">,</span> <span class="mf">8.6</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  <span class="c1"># plotting SAMI filler lower limits</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.045</span><span class="p">,</span> <span class="mf">0.06</span><span class="p">],</span> <span class="p">[</span><span class="mf">9.4</span><span class="p">,</span> <span class="mf">9.4</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  <span class="c1"># plotting SAMI filler lower limits</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.06</span><span class="p">,</span> <span class="mf">0.095</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.3</span><span class="p">,</span> <span class="mf">10.3</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  <span class="c1"># plotting SAMI filler lower limits</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mf">0.095</span><span class="p">,</span> <span class="mf">0.115</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.9</span><span class="p">,</span> <span class="mf">10.9</span><span class="p">],</span> <span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>  <span class="c1"># plotting SAMI filler lower limits</span>

        <span class="c1"># Add in the lines and fractions of galaxies in each box</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">add_boxes_to_Mstar_z</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Mstar&#39;</span><span class="p">)</span>

        <span class="c1"># Add in the source densities</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_area</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">density_in_selection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_area</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">density_above_SB_limit</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_area</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
            <span class="n">density_in_sparse_sampled_selection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_area</span><span class="p">,</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">density_in_selection</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
            <span class="n">density_above_SB_limit</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>
            <span class="n">density_in_sparse_sampled_selection</span> <span class="o">=</span> <span class="s1">&#39;N/A&#39;</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.11</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="n">density_above_SB_limit</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="n">density_in_selection</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.08</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="n">density_in_sparse_sampled_selection</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.04</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">,</span> <span class="s2">&quot;Gal/2dF(3.14sq.deg)=&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

    <span class="k">def</span> <span class="nf">_plot_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot a histogram of a column.</span>
<span class="sd">        If given, mask should be a list of three masks for each table. </span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">red</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">blue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>
        <span class="n">magenta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">column_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">]</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">red</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>    
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">blue</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">magenta</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;No. galaxies&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span>

<div class="viewcode-block" id="HectorSim.plot_mass_hist"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_mass_hist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_mass_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="s1">&#39;Mstar&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_bins</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Stellar Mass&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_z_hist"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_z_hist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_z_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.12</span><span class="p">,</span> <span class="mi">31</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Redshift&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_Re_hist"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_Re_hist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_Re_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">Remin</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">Remax</span> <span class="o">=</span> <span class="mi">15</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">Remin</span><span class="p">,</span> <span class="n">Remax</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">((</span><span class="n">Remax</span> <span class="o">-</span> <span class="n">Remin</span><span class="p">)</span> <span class="o">*</span> <span class="mf">4.</span><span class="p">)))</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="s1">&#39;Re&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.7</span><span class="p">,</span> <span class="mf">0.92</span><span class="p">,</span> <span class="s2">&quot;median Re&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>  <span class="c1"># was 13, 600</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.85</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">Re</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">Re</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.75</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmedian</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">Re</span><span class="p">),</span> <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;R_e (arcsec)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_gmi_hist"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_gmi_hist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_gmi_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="s1">&#39;g_m_i&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;g-i colour&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_ellipticity_hist"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_ellipticity_hist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_ellipticity_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">bins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">21</span><span class="p">)</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="s1">&#39;Ellipticity_r&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Ellipticity&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_SB_Re"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_SB_Re">[docs]</a>    <span class="k">def</span> <span class="nf">plot_SB_Re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="c1"># plt.plot(HECTORdata_Retemp,HECTORdata_SB, &#39;.&#39;, color=&#39;magenta&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">Re</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">Re</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Re (arcsec)&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Surface Brightness</span><span class="se">\n</span><span class="s1"> (mag/arcsec^2)&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_IFU_needed_for_2Re_hist"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_IFU_needed_for_2Re_hist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_IFU_needed_for_2Re_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_plot_hist</span><span class="p">(</span><span class="s1">&#39;IFU_diam_2Re&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">60.0</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;IFU diameter required for 2Re (arcsec)&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

    <span class="k">def</span> <span class="nf">_get_fraction_of_sample_which_fits_in_IFU_diameter</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Bin up the sample using np.histogram in terms of the diameter of a 2Re circle for each galaxy. We then work out the fraction of the sample which is less than each diameter (by dividing by N_total). This is a bit like a KDE of table.IFU_diam_2Re, but not quite! KDEs integrate to 1 whereas these values _sum_ to 1</span>
<span class="sd">        Order is [red, blue, magenta]</span>

<span class="sd">        Returns: A list of fractions, A list of bin edges.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">N_pto</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">IFU_diam_2Re</span><span class="o">.</span><span class="n">size</span>
        <span class="n">pto_binned_IFU_diam</span><span class="p">,</span> <span class="n">bin_edges_pto</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">IFU_diam_2Re</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

        <span class="n">N_sf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">IFU_diam_2Re</span><span class="o">.</span><span class="n">size</span>
        <span class="n">sf_binned_IFU_diam</span><span class="p">,</span> <span class="n">bin_edges_sf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">IFU_diam_2Re</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

        <span class="n">N_sfss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">IFU_diam_2Re</span><span class="o">.</span><span class="n">size</span>
        <span class="n">sfss_binned_IFU_diam</span><span class="p">,</span> <span class="n">bin_edges_sfss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">IFU_diam_2Re</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>

        <span class="n">fractions</span> <span class="o">=</span> <span class="p">[</span><span class="n">pto_binned_IFU_diam</span> <span class="o">/</span> <span class="n">N_pto</span><span class="p">,</span> <span class="n">sf_binned_IFU_diam</span> <span class="o">/</span> <span class="n">N_sf</span><span class="p">,</span> <span class="n">sfss_binned_IFU_diam</span> <span class="o">/</span> <span class="n">N_sfss</span><span class="p">]</span>
        <span class="n">bins</span> <span class="o">=</span> <span class="p">[</span><span class="n">bin_edges_pto</span><span class="p">,</span> <span class="n">bin_edges_sf</span><span class="p">,</span> <span class="n">bin_edges_sfss</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">fractions</span><span class="p">,</span> <span class="n">bins</span>

<div class="viewcode-block" id="HectorSim.plot_IFU_needed_for_2Re_kde"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_IFU_needed_for_2Re_kde">[docs]</a>    <span class="k">def</span> <span class="nf">plot_IFU_needed_for_2Re_kde</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">fractions</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fraction_of_sample_which_fits_in_IFU_diameter</span><span class="p">()</span>

        <span class="n">bin_edges_pto</span><span class="p">,</span> <span class="n">bin_edges_sf</span><span class="p">,</span> <span class="n">bin_edges_sfss</span> <span class="o">=</span> <span class="n">bins</span>
        <span class="n">fractions_pto</span><span class="p">,</span> <span class="n">fractions_sf</span><span class="p">,</span> <span class="n">fractions_sfss</span> <span class="o">=</span> <span class="n">fractions</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edges_sfss</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">fractions_sfss</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edges_sf</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">fractions_sf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edges_pto</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">fractions_pto</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Bundle diameter to reach 2Re (arcsec)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative frac. sample</span><span class="se">\n</span><span class="s2"> for 2Re every galaxy&quot;</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;IFU diameter required for 2Re (arcsec)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Fraction of Sample&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_cumulative_fraction_imaged_vs_bundle_diameter"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_cumulative_fraction_imaged_vs_bundle_diameter">[docs]</a>    <span class="k">def</span> <span class="nf">plot_cumulative_fraction_imaged_vs_bundle_diameter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;127&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="s2">&quot;num. 105um fibres/bundle&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">36</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;469&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">55</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;1027&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">75</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;1801&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>

        <span class="n">fractions</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fraction_of_sample_which_fits_in_IFU_diameter</span><span class="p">()</span>

        <span class="n">bin_edges_pto</span><span class="p">,</span> <span class="n">bin_edges_sf</span><span class="p">,</span> <span class="n">bin_edges_sfss</span> <span class="o">=</span> <span class="n">bins</span>
        <span class="n">fractions_pto</span><span class="p">,</span> <span class="n">fractions_sf</span><span class="p">,</span> <span class="n">fractions_sfss</span> <span class="o">=</span> <span class="n">fractions</span>

        <span class="c1"># cumulative_IFU_diam_pto = np.cumsum(fractions_pto)</span>
        <span class="n">cumulative_IFU_diam_sf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">fractions_sf</span><span class="p">)</span>
        <span class="n">cumulative_IFU_diam_sfss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">fractions_sfss</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edges_sf</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cumulative_IFU_diam_sf</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">bin_edges_sfss</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">cumulative_IFU_diam_sfss</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Bundle diameter to reach 2Re (arcsec)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Cumulative frac. sample</span><span class="se">\n</span><span class="s2"> for 2Re every galaxy&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.cumulative_fraction_sample_imaged_to_2Re"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.cumulative_fraction_sample_imaged_to_2Re">[docs]</a>    <span class="k">def</span> <span class="nf">cumulative_fraction_sample_imaged_to_2Re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lines 1435-1486</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">fractions</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_fraction_of_sample_which_fits_in_IFU_diameter</span><span class="p">()</span>

        <span class="n">bin_edges_pto</span><span class="p">,</span> <span class="n">bin_edges_sf</span><span class="p">,</span> <span class="n">bin_edges_sfss</span> <span class="o">=</span> <span class="n">bins</span>
        <span class="n">fractions_pto</span><span class="p">,</span> <span class="n">fractions_sf</span><span class="p">,</span> <span class="n">fractions_sfss</span> <span class="o">=</span> <span class="n">fractions</span>

        <span class="n">DIA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.676190476</span><span class="p">,</span> <span class="mf">5.028571429</span><span class="p">,</span> <span class="mf">8.380952381</span><span class="p">,</span> <span class="mf">11.73333333</span><span class="p">,</span> <span class="mf">15.08571429</span><span class="p">,</span> <span class="mf">18.43809524</span><span class="p">,</span> <span class="mf">21.79047619</span><span class="p">,</span> <span class="mf">25.14285714</span><span class="p">,</span> <span class="mf">28.4952381</span><span class="p">,</span> <span class="mf">31.84761905</span><span class="p">,</span> <span class="mf">35.2</span><span class="p">,</span> <span class="mf">38.55238095</span><span class="p">,</span> <span class="mf">41.9047619</span><span class="p">,</span> <span class="mf">45.25714286</span><span class="p">,</span> <span class="mf">48.60952381</span><span class="p">,</span> <span class="mf">51.96190476</span><span class="p">,</span> <span class="mf">55.31428571</span><span class="p">,</span> <span class="mf">58.66666667</span><span class="p">,</span> <span class="mf">62.01904762</span><span class="p">,</span> <span class="mf">65.37142857</span><span class="p">,</span> <span class="mf">68.72380952</span><span class="p">,</span> <span class="mf">72.07619048</span><span class="p">,</span> <span class="mf">75.42857143</span><span class="p">,</span> <span class="mf">78.78095238</span><span class="p">,</span> <span class="mf">82.13333333</span><span class="p">,</span> <span class="mf">85.48571429</span><span class="p">,</span> <span class="mf">88.83809524</span><span class="p">,</span> <span class="mf">92.19047619</span><span class="p">,</span> <span class="mf">95.54285714</span><span class="p">,</span> <span class="mf">98.8952381</span><span class="p">,</span> <span class="mf">102.247619</span><span class="p">,</span> <span class="mf">105.6</span><span class="p">])</span>  <span class="c1"># assumes 105um cores with 5um cladding.</span>
        <span class="c1"># coresize = 105</span>
        <span class="n">CORES</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">331</span><span class="p">,</span> <span class="mi">397</span><span class="p">,</span> <span class="mi">469</span><span class="p">,</span> <span class="mi">547</span><span class="p">,</span> <span class="mi">631</span><span class="p">,</span> <span class="mi">721</span><span class="p">,</span> <span class="mi">817</span><span class="p">,</span> <span class="mi">919</span><span class="p">,</span> <span class="mi">1027</span><span class="p">,</span> <span class="mi">1141</span><span class="p">,</span> <span class="mi">1261</span><span class="p">,</span> <span class="mi">1387</span><span class="p">,</span> <span class="mi">1519</span><span class="p">,</span> <span class="mi">1657</span><span class="p">,</span> <span class="mi">1801</span><span class="p">,</span> <span class="mi">1951</span><span class="p">,</span> <span class="mi">2107</span><span class="p">,</span> <span class="mi">2269</span><span class="p">,</span> <span class="mi">2437</span><span class="p">,</span> <span class="mi">2611</span><span class="p">,</span> <span class="mi">2791</span><span class="p">,</span> <span class="mi">2977</span><span class="p">])</span>

        <span class="c1"># Now want cumulative fraction of bundles at each diameter and plot</span>
        <span class="c1"># Set maximum bundle size that is likely as 469=core, or the 13th element of the CORES and DIA arrays, which is overkill, but set here (-1 because 0 to 12 array):</span>
        <span class="n">MAX_bundle</span> <span class="o">=</span> <span class="mi">13</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="n">coresplot</span> <span class="o">=</span> <span class="n">CORES</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">MAX_bundle</span><span class="p">]</span>
        <span class="n">bundles_frac_magenta</span> <span class="o">=</span> <span class="p">[]</span>  <span class="c1"># to make a zero length array that I will append to during the loop.</span>
        <span class="n">bundles_frac_blue</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">MAX_bundle</span><span class="p">):</span>
            <span class="c1"># test = np.where(CORES==i) #find the index at position i, as a tuple</span>
            <span class="c1"># tempindex = np.int(test[0]) # make theindex an integer</span>
            <span class="c1"># tempDIA[i] = DIA[tempindex[i]] # find the DIA value for that index</span>

            <span class="n">bundles</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">bin_edges_sf</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">DIA</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># find first bin in the cumulative bundle diameter for 2Re plot</span>
            <span class="c1"># print &quot;bundles&quot;, bundles</span>
            <span class="c1"># print &quot;binsb&quot;, binsb</span>
            <span class="c1"># print &quot;DIA&quot;, DIA[i]</span>
            <span class="n">bundles_zLT0pt1</span> <span class="o">=</span> <span class="n">bisect</span><span class="o">.</span><span class="n">bisect</span><span class="p">(</span><span class="n">bin_edges_sfss</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">DIA</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="c1"># Now sum the fract_bundlediam_2Re fraction of galaxies at 2Re from the 0th element to the &quot;bundles&quot; element (should be equivalent to the bundles-th element of cumulative array:</span>
            <span class="n">bundles_frac_magenta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fractions_sfss</span><span class="p">[</span><span class="mi">0</span><span class="p">:(</span><span class="n">bundles</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]))</span>
            <span class="c1"># print &quot;bundles_frac&quot;, bundles_frac</span>
            <span class="n">bundles_frac_blue</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fractions_sf</span><span class="p">[</span><span class="mi">0</span><span class="p">:(</span><span class="n">bundles_zLT0pt1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)]))</span>
            <span class="c1"># bundlesar = np.asarray(bundles)</span>
            <span class="c1"># for j in bundles:</span>
        <span class="c1"># total_fraction = cumulative[j] #find the total fraction of galaxies with 2Re&lt;the diameter of the bundle for all bundle sizes. eg: all 2Re bins smaller than an nth-core hexabundle, are summed, so we get the cumulative fraction of galaxies that would fit within that bundle size.</span>
        <span class="n">bundles_frac_magenta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">bundles_frac_magenta</span><span class="p">)</span>  <span class="c1"># This converts the list to an array.</span>
        <span class="c1"># print &quot;bundles_frac_arr&quot;, bundles_frac_arr</span>
        <span class="n">bundles_frac_blue</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span><span class="n">bundles_frac_blue</span><span class="p">)</span>

        <span class="c1"># Now plot the bundles size in no. of cores vs fraction of galaxies:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coresplot</span><span class="p">,</span> <span class="n">bundles_frac_magenta</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">coresplot</span><span class="p">,</span> <span class="n">bundles_frac_blue</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">19</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;19&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;37&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">37</span><span class="p">,</span> <span class="mi">37</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">61</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;61&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">61</span><span class="p">,</span> <span class="mi">61</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">91</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;91&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">91</span><span class="p">,</span> <span class="mi">91</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;127&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">169</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;169&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">169</span><span class="p">,</span> <span class="mi">169</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">217</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="s2">&quot;217&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;cumulative frac. of galaxies&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;No.cores in the bundle that just fits 2Re&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_SB_hist"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_SB_hist">[docs]</a>    <span class="k">def</span> <span class="nf">plot_SB_hist</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot histograms of effective surface brightness within 1Re and surface brightness at 2 and 3Re. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bins</span> <span class="o">=</span> <span class="mi">50</span>
        <span class="c1"># Check if surface brightness is nan, as otherwise hist complains</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">)):</span>
            <span class="c1"># Check if we&#39;ve been able to make surface brightness measurements at larger radii too</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">GAL_MU_R_at_2Re</span><span class="p">)):</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">GAL_MU_R_at_3Re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">GAL_MU_R_at_3Re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">GAL_MU_R_at_3Re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>

                <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">GAL_MU_R_at_2Re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">GAL_MU_R_at_2Re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">GAL_MU_R_at_2Re</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">GAL_MU_E_R</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>   
            <span class="c1"># Plot some fake data otherwise matplotlib complains when I try and    </span>
            <span class="c1"># ax.hist(np.random.normal(loc=20, scale=3, size=100), alpha=0.0)      </span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">250</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">28</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Surface brightness at 1Re (filled) </span><span class="se">\n</span><span class="s2"> and 2Re (tranparent)</span><span class="se">\n</span><span class="s2"> and 3Re (most transparent) (mag/arcsec^2)&quot;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;No. galaxies&#39;</span><span class="p">)</span>

        <span class="c1"># Line at the limiting surface brightness of a SAMI galaxy to get S/N ~5 after 4 hours when when binned up </span>
        <span class="c1"># by 24 cores</span>
        <span class="c1"># ax.axvline(25, &#39;-&#39;, color=&#39;green&#39;)</span>
        
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.plot_percentage_galaxy_sample_imaged_2Re"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.plot_percentage_galaxy_sample_imaged_2Re">[docs]</a>    <span class="k">def</span> <span class="nf">plot_percentage_galaxy_sample_imaged_2Re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lines 1597 - 1707</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># TotalFracto2Re=((percent100umcores[7,1]+percent100umcores[8,1]) - percentfinalbundledistribution[7,1])+ (percent100umcores[6,1]-(percentfinalbundledistribution[6,1]-(percent100umcores[7,1] - percentfinalbundledistribution[7,1]))) + (percent100umcores[5,1]-(percentfinalbundledistribution[5,1]-((percent100umcores[6,1]-(percentfinalbundledistribution[6,1]-(percent100umcores[7,1] - percentfinalbundledistribution[7,1])))))) + (percent100umcores[4,1]-(percentfinalbundledistribution[4,1]- ((percent100umcores[5,1]-(percentfinalbundledistribution[5,1]-((percent100umcores[6,1]-(percentfinalbundledistribution[6,1]-(percent100umcores[7,1] - percentfinalbundledistribution[7,1])))))))))</span>

        <span class="n">percent100umcores</span><span class="p">,</span> <span class="n">percent100umcores_zLT0pt1</span><span class="p">,</span> <span class="n">percent75umcores</span><span class="p">,</span> <span class="n">cores9</span><span class="p">,</span> <span class="n">cores13</span><span class="p">,</span> <span class="n">TotalFracto2Re</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_percent_100um_cores</span><span class="p">()</span>

        <span class="c1"># ax = fig3.add_subplot(2,4,8)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cores9</span><span class="p">,</span> <span class="n">percent100umcores</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;105um fibres&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cores9</span><span class="p">,</span> <span class="n">percent100umcores_zLT0pt1</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;105um fibres&#39;</span><span class="p">)</span>
        <span class="c1"># ax.plot(cores13,percent75umcores[:,1], &#39;-.&#39;, color=&#39;magenta&#39;,label=&#39;75um fibres&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;19&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">19</span><span class="p">,</span> <span class="mi">19</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">37</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;37&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">37</span><span class="p">,</span> <span class="mi">37</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">61</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;61&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">61</span><span class="p">,</span> <span class="mi">61</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">91</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;91&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">91</span><span class="p">,</span> <span class="mi">91</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">127</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;127&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">127</span><span class="p">,</span> <span class="mi">127</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">169</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;169&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">169</span><span class="p">,</span> <span class="mi">169</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">217</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="s2">&quot;217&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">217</span><span class="p">,</span> <span class="mi">217</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span> <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Percentage (magenta)</span><span class="se">\n</span><span class="s2">imaged to 2Re = &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">TotalFracto2Re</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;%&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">bbox</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">boxstyle</span><span class="o">=</span><span class="s1">&#39;round,pad=0.1&#39;</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">300</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;No.cores in the bundle that just fits 2Re&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">% g</span><span class="s1">alaxy sample </span><span class="se">\n</span><span class="s1"> imaged to 2Re&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>



    <span class="k">def</span> <span class="nf">_get_percent_100um_cores</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">bundlediam_2Re</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="p">[</span><span class="s1">&#39;IFU_diam_2Re&#39;</span><span class="p">]</span>
        <span class="n">bundlediam_2Re_zLT0pt1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">selection_function</span><span class="p">[</span><span class="s1">&#39;IFU_diam_2Re&#39;</span><span class="p">]</span>

        <span class="n">cores9</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">170</span><span class="p">]</span>  <span class="c1"># 217, 218]</span>
        <span class="n">cores13</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">127</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">271</span><span class="p">,</span> <span class="mi">331</span><span class="p">,</span> <span class="mi">397</span><span class="p">,</span> <span class="mi">469</span><span class="p">,</span> <span class="mi">470</span><span class="p">]</span>
        <span class="c1"># diamfor100umcores = [1.726476, 5.17942857, 8.63238, 12.085333, 15.5382857, 18.99123809, 22.44419, 25.89714]  # , 28.4952381]  updated for 103um core and max 169 cores</span>
        <span class="c1"># diamfor75umcores = [1.219047619, 3.657142857, 6.095238095, 8.533333333, 10.97142857, 13.40952381, 15.84761905, 18.28571429, 20.72380952, 23.16190476, 25.6, 28.03809524, 30.47619048]</span>
        <span class="c1"># percentcores = [0.3, 3.5, 9.5, 13.8, 15.6, 13, 11, 9, 6]</span>
        <span class="c1"># plt.plot(cores, percentcores) which I quickly plotted for my instrument science talk.</span>
        <span class="c1"># Make a temporary array for the number of galaxies for each of these 9 diameters plus an extra one for &gt; 28.5</span>
        <span class="n">percent100umcores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.726476</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.17942857</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.63238</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.085333</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.5382857</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.99123809</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.44419</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">25.89714</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  <span class="c1"># Note:points at 28 are for everything &gt;25.897</span>
        <span class="n">percent100umcores_zLT0pt1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.726476</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.17942857</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.63238</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.085333</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.5382857</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.99123809</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.44419</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">25.89714</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  <span class="c1"># Note:points at 30 are for everything &gt;28.5</span>
        <span class="n">percent75umcores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.219047619</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.657142857</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">6.095238095</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.533333333</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">10.97142857</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">13.40952381</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.84761905</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.28571429</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">20.72380952</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">23.16190476</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">25.6</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">28.03809524</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mf">30.47619048</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>  <span class="c1"># Note:points at 35 are for everything &gt;30.5</span>
        <span class="n">lenpc100</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">percent100umcores</span><span class="p">)</span>
        <span class="n">lenpc75</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">percent75umcores</span><span class="p">)</span>

        <span class="n">percentfinalbundledistribution</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">1.726476</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">5.17942857</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">8.63238</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">12.085333</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mf">15.5382857</span><span class="p">,</span> <span class="p">(</span><span class="mf">14.</span> <span class="o">/</span> <span class="mf">19.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mf">18.99123809</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">/</span> <span class="mf">19.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mf">22.44419</span><span class="p">,</span> <span class="p">(</span><span class="mf">1.</span> <span class="o">/</span> <span class="mf">19.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mf">25.89714</span><span class="p">,</span> <span class="p">(</span><span class="mf">2.</span> <span class="o">/</span> <span class="mf">19.</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]])</span>  <span class="c1"># excluding the 2 star bundles</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenpc100</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span> <span class="o">&lt;</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">))))</span> <span class="o">*</span> <span class="mi">100</span>
                <span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="p">[(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="o">&lt;</span><span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent100umcores_zLT0pt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span><span class="o">&lt;</span><span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span><span class="o">&lt;</span><span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span> <span class="o">-</span> <span class="n">test2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="p">[(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="o">&lt;</span><span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="p">[(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="o">&lt;</span><span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span> <span class="o">-</span> <span class="n">test2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent100umcores_zLT0pt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="p">(</span><span class="n">lenpc100</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span><span class="o">&gt;</span><span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="p">[(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="o">&gt;</span><span class="n">percent100umcores</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re_zLT0pt1</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent100umcores_zLT0pt1</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
        <span class="c1">#print percent100umcores</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">lenpc75</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">test1</span><span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span><span class="o">&lt;</span><span class="n">percent75umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent75umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
            <span class="k">if</span> <span class="n">i</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span><span class="o">&lt;</span><span class="n">percent75umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test2</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span><span class="o">&lt;</span><span class="n">percent75umcores</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span> <span class="o">-</span> <span class="n">test2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent75umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="p">(</span><span class="n">lenpc75</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="n">test1</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">[(</span><span class="n">bundlediam_2Re</span><span class="o">&gt;</span><span class="n">percent75umcores</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">])]))</span>
                <span class="n">test3</span> <span class="o">=</span> <span class="p">((</span><span class="n">test1</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bundlediam_2Re</span><span class="p">))))</span><span class="o">*</span><span class="mi">100</span>
                <span class="n">percent75umcores</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">test3</span>
        <span class="c1">#print percent75umcores</span>

        <span class="c1"># Now calculate the fraction of all galaxies that are imaged to 2Re if the largest is put in the largest bundle etc, down to the smallest - i.e. not allowing for tiling variations.</span>
        <span class="c1">#Total</span>
        <span class="k">if</span>  <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">numfit169</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numleft169</span> <span class="o">=</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numfit169</span> <span class="o">=</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">percent100umcores</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">numleft169</span> <span class="o">=</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">numfit169</span> <span class="c1">#number in the 169 bin that did not fit</span>
        <span class="k">if</span>  <span class="n">numleft169</span> <span class="o">&gt;</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">numfit127</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numleft127</span> <span class="o">=</span> <span class="n">numleft169</span> <span class="o">-</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numfit127</span> <span class="o">=</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">numleft169</span>
            <span class="n">numleft127</span> <span class="o">=</span> <span class="n">numleft169</span> <span class="o">-</span> <span class="n">numfit127</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span>  <span class="n">numleft127</span> <span class="o">&gt;</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">numfit91</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numleft91</span> <span class="o">=</span> <span class="n">numleft127</span> <span class="o">-</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numfit91</span> <span class="o">=</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">numleft127</span>
            <span class="n">numleft91</span> <span class="o">=</span> <span class="n">numleft127</span> <span class="o">-</span> <span class="n">numfit91</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span>  <span class="n">numleft91</span> <span class="o">&gt;</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]:</span>
            <span class="n">numfit61</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">numleft61</span> <span class="o">=</span> <span class="n">numleft91</span> <span class="o">-</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">numfit61</span> <span class="o">=</span> <span class="n">percentfinalbundledistribution</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span> <span class="n">numleft91</span>
            <span class="n">numleft61</span> <span class="o">=</span> <span class="n">numleft91</span> <span class="o">-</span> <span class="n">numfit61</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">TotalFracto2Re</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">numfit169</span> <span class="o">+</span> <span class="n">numfit127</span> <span class="o">+</span> <span class="n">numfit91</span> <span class="o">+</span> <span class="n">numfit61</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">percent100umcores</span><span class="p">,</span> <span class="n">percent100umcores_zLT0pt1</span><span class="p">,</span> <span class="n">percent75umcores</span><span class="p">,</span> <span class="n">cores9</span><span class="p">,</span> <span class="n">cores13</span><span class="p">,</span> <span class="n">TotalFracto2Re</span>



<div class="viewcode-block" id="HectorSim.cumulative_percentage_galaxies_imaged_2Re"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.cumulative_percentage_galaxies_imaged_2Re">[docs]</a>    <span class="k">def</span> <span class="nf">cumulative_percentage_galaxies_imaged_2Re</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lines 1716- 1798</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">percent100umcores</span><span class="p">,</span> <span class="n">percent100umcores_zLT0pt1</span><span class="p">,</span> <span class="n">percent75umcores</span><span class="p">,</span> <span class="n">cores9</span><span class="p">,</span> <span class="n">cores13</span><span class="p">,</span> <span class="n">TotalFracto2Re</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_percent_100um_cores</span><span class="p">()</span>

        <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent100umcores</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#print &quot;percent100umcores&quot;,percent100umcores</span>
        <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">percent75umcores</span><span class="p">[</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1">#***</span>


        <span class="c1">#Now do cumulative plot vs cumulative number of cores:</span>
        <span class="n">cum_pc100umcores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1">#print &quot;cum_pc100umcores&quot;, cum_pc100umcores</span>
        <span class="n">cum_pc75umcores</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">totalbundles</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">20</span><span class="p">])</span> <span class="c1">#total number of hexabundles</span>
        <span class="n">cores9_sumfibrenumbers_100</span> <span class="o">=</span> <span class="n">cores9</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cumcores9_sumfibrenumbers_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores9_sumfibrenumbers_100</span><span class="p">)</span>
        <span class="n">cores9_sumfibrenumbers_90</span> <span class="o">=</span> <span class="n">cores9</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">cumcores9_sumfibrenumbers_90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores9_sumfibrenumbers_90</span><span class="p">)</span>
        <span class="n">cores9_sumfibrenumbers_80</span> <span class="o">=</span> <span class="n">cores9</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">cumcores9_sumfibrenumbers_80</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores9_sumfibrenumbers_80</span><span class="p">)</span>
        <span class="n">cores9_sumfibrenumbers_70</span> <span class="o">=</span> <span class="n">cores9</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">cumcores9_sumfibrenumbers_70</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores9_sumfibrenumbers_70</span><span class="p">)</span>
        <span class="n">cores9_sumfibrenumbers_60</span> <span class="o">=</span> <span class="n">cores9</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">cumcores9_sumfibrenumbers_60</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores9_sumfibrenumbers_60</span><span class="p">)</span>
        <span class="n">cores9_sumfibrenumbers_50</span> <span class="o">=</span> <span class="n">cores9</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">cumcores9_sumfibrenumbers_50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores9_sumfibrenumbers_50</span><span class="p">)</span>
        <span class="n">cores9_sumfibrenumbers_20</span> <span class="o">=</span> <span class="n">cores9</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent100umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">cumcores9_sumfibrenumbers_20</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores9_sumfibrenumbers_20</span><span class="p">)</span>
        <span class="n">percentintervals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
        <span class="n">percentintervals_100um_50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">percentintervals</span><span class="p">,</span><span class="n">cum_pc100umcores</span><span class="p">,</span> <span class="n">cumcores9_sumfibrenumbers_50</span><span class="p">)</span><span class="c1">#print the cumulative number of cores at 90% to work out total angular area. Note had to reverse x and y</span>
        <span class="n">percentintervals_100um_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">percentintervals</span><span class="p">,</span><span class="n">cum_pc100umcores</span><span class="p">,</span> <span class="n">cumcores9_sumfibrenumbers_100</span><span class="p">)</span>
        <span class="c1"># print &quot;Number of 105um cores in 50 hexas when&quot;, percentintervals[18],&quot;% of galaxies imaged to 2Re is&quot;,percentintervals_100um_50[18],&quot;which is a total fibre area of&quot;, percentintervals_100um_50[18] * pi * (0.8**2.), &quot;arcsec^2&quot;</span>
        <span class="c1"># print &quot;Number of 105um cores in 100 hexas when&quot;, percentintervals[18],&quot;% of galaxies imaged to 2Re is&quot;,percentintervals_100um_100[18],&quot;which is a total fibre area of&quot;, percentintervals_100um_100[18] * pi * (0.8**2.), &quot;arcsec^2&quot;</span>


        <span class="n">cores13_sumfibrenumbers_100</span> <span class="o">=</span> <span class="n">cores13</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cumcores13_sumfibrenumbers_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores13_sumfibrenumbers_100</span><span class="p">)</span>
        <span class="n">cores13_sumfibrenumbers_90</span> <span class="o">=</span> <span class="n">cores13</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">cumcores13_sumfibrenumbers_90</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores13_sumfibrenumbers_90</span><span class="p">)</span>
        <span class="n">cores13_sumfibrenumbers_80</span> <span class="o">=</span> <span class="n">cores13</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">cumcores13_sumfibrenumbers_80</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores13_sumfibrenumbers_80</span><span class="p">)</span>
        <span class="n">cores13_sumfibrenumbers_70</span> <span class="o">=</span> <span class="n">cores13</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">cumcores13_sumfibrenumbers_70</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores13_sumfibrenumbers_70</span><span class="p">)</span>
        <span class="n">cores13_sumfibrenumbers_60</span> <span class="o">=</span> <span class="n">cores13</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span>
        <span class="n">cumcores13_sumfibrenumbers_60</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores13_sumfibrenumbers_60</span><span class="p">)</span>
        <span class="n">cores13_sumfibrenumbers_50</span> <span class="o">=</span> <span class="n">cores13</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">cumcores13_sumfibrenumbers_50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores13_sumfibrenumbers_50</span><span class="p">)</span>
        <span class="n">cores13_sumfibrenumbers_20</span> <span class="o">=</span> <span class="n">cores13</span> <span class="o">*</span> <span class="p">(</span><span class="n">percent75umcores</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span><span class="mi">100</span><span class="p">)</span> <span class="o">*</span> <span class="n">totalbundles</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
        <span class="n">cumcores13_sumfibrenumbers_20</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">cores13_sumfibrenumbers_20</span><span class="p">)</span>
        <span class="n">percentintervals</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="mi">25</span><span class="p">,</span><span class="mi">30</span><span class="p">,</span><span class="mi">35</span><span class="p">,</span><span class="mi">40</span><span class="p">,</span><span class="mi">45</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">55</span><span class="p">,</span><span class="mi">60</span><span class="p">,</span><span class="mi">65</span><span class="p">,</span><span class="mi">70</span><span class="p">,</span><span class="mi">75</span><span class="p">,</span><span class="mi">80</span><span class="p">,</span><span class="mi">85</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">95</span><span class="p">,</span><span class="mi">100</span><span class="p">])</span>
        <span class="n">percentintervals_75um_50</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">percentintervals</span><span class="p">,</span><span class="n">cum_pc75umcores</span><span class="p">,</span> <span class="n">cumcores13_sumfibrenumbers_50</span><span class="p">)</span><span class="c1">#print the cumulative number of cores at 90% to work out total angular area. Note had to reverse x and y</span>
        <span class="n">percentintervals_75um_100</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">percentintervals</span><span class="p">,</span><span class="n">cum_pc75umcores</span><span class="p">,</span> <span class="n">cumcores13_sumfibrenumbers_100</span><span class="p">)</span>
        <span class="c1"># print &quot;Number of 75um cores in 50 hexas when&quot;, percentintervals[18],&quot;% of galaxies imaged to 2Re is&quot;,percentintervals_75um_50[18],&quot;which is a total fibre area of&quot;, percentintervals_75um_50[18] * pi * ((0.75*0.8)**2.), &quot;arcsec^2&quot;</span>
        <span class="c1"># print &quot;Number of 75um cores in 100 hexas when&quot;, percentintervals[18],&quot;% of galaxies imaged to 2Re is&quot;,percentintervals_75um_100[18],&quot;which is a total fibre area of&quot;, percentintervals_75um_100[18] * pi * ((0.75*0.8)**2.), &quot;arcsec^2&quot;</span>

        <span class="c1">#plt.plot(cumcores9_sumfibrenumbers_100,cum_pc100umcores, &#39;-o&#39;, color=&#39;green&#39;,label=&#39;100&#39;)</span>
        <span class="c1">#plt.plot(cumcores9_sumfibrenumbers_90,cum_pc100umcores, &#39;-o&#39;, color=&#39;cyan&#39;,label=&#39;90&#39;)</span>
        <span class="c1">#plt.plot(cumcores9_sumfibrenumbers_80,cum_pc100umcores, &#39;-o&#39;, color=&#39;blue&#39;,label=&#39;80&#39;)</span>
        <span class="c1">#plt.plot(cumcores9_sumfibrenumbers_70,cum_pc100umcores, &#39;-o&#39;, color=&#39;red&#39;,label=&#39;70&#39;)</span>
        <span class="c1">#plt.plot(cumcores9_sumfibrenumbers_60,cum_pc100umcores, &#39;-o&#39;, color=&#39;magenta&#39;,label=&#39;60&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cumcores9_sumfibrenumbers_50</span><span class="p">,</span><span class="n">cum_pc100umcores</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;50&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">cumcores9_sumfibrenumbers_20</span><span class="p">,</span><span class="n">cum_pc100umcores</span><span class="p">,</span> <span class="s1">&#39;-o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;20&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5000</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Cumulative number of</span><span class="se">\n</span><span class="s1"> 105 micron fibres&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Cumulative </span><span class="si">% g</span><span class="s1">alaxies</span><span class="se">\n</span><span class="s1"> imaged to 2Re&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3500</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="s2">&quot;Num.</span><span class="se">\n</span><span class="s2"> bundles&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="c1">#ax.text(7000, 50, &quot;100&quot;, color = &#39;green&#39;)</span>
        <span class="c1">#ax.text(7000, 40, &quot;90&quot;, color = &#39;cyan&#39;)</span>
        <span class="c1">#ax.text(7000, 30, &quot;80&quot;, color = &#39;blue&#39;)</span>
        <span class="c1">#ax.text(7000, 20, &quot;70&quot;, color = &#39;red&#39;)</span>
        <span class="c1">#ax.text(7000, 10, &quot;60&quot;, color = &#39;magenta&#39;)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s2">&quot;50&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;orange&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">4000</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="s2">&quot;20&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;cyan&#39;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="HectorSim.make_Julias_plot"><a class="viewcode-back" href="../../../hop.target_selection.html#hop.target_selection.HectorSim.HectorSim.make_Julias_plot">[docs]</a>    <span class="k">def</span> <span class="nf">make_Julias_plot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Make an indetical plot to Julia&#39;s Hector sim code</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">axs</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Must pass axes of shape (3, 6)- these have shape </span><span class="si">{</span><span class="n">axs</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_selected_sample_MZ_colour_Re</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_selected_sample_MZ</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_mass_hist</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_Re_hist</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_IFU_needed_for_2Re_hist</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_IFU_needed_for_2Re_kde</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_parent_sample</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_z_hist</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ellipticity_hist</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_percentage_galaxy_sample_imaged_2Re</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cumulative_fraction_sample_imaged_to_2Re</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_SB_hist</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_SB_Re</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_gmi_hist</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_Mstar_z_gi_colour</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_z_Re</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_cumulative_fraction_imaged_vs_bundle_diameter</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cumulative_percentage_galaxies_imaged_2Re</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span></div></div>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>

    <span class="c1"># get rid of the pandas false positive warning</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># Use the local style file I made</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;./HectorSim.mplstyle&#39;</span><span class="p">)</span>

    <span class="kn">import</span> <span class="nn">argparse</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Simulate Hector Observations using a variety of input catalogues&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;BoundaryType&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Must be Taipan or SAMI (not case sensitive)&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;zlimit&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Maximum redshift&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;MstarMin&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Minimum Mstar&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;MstarMax&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Maximum Mstar&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;SparseFunction&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Sparse selection function. Must be 1 or 2 (FIXME)&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;SourceCat&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Short name for input catalogue&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;MSparseCut1&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Select flat in M* above this mass&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;minRe&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Minimum Re of galaxies to select (in kpc? arcsec?)&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--quiet&quot;</span><span class="p">,</span> <span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Suppress printing to the terminal&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--Dec_Min&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Minimum Dec of the observations. Useful for selecting a strip of targets&quot;</span><span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--Dec_Max&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">float</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Maximum Dec of the observations. Useful for selecting a strip of targets&quot;</span><span class="p">)</span>



    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>


    <span class="n">config</span> <span class="o">=</span> <span class="n">_load_config</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">SourceCat</span><span class="p">)</span>
    <span class="n">full_catalogue_table</span> <span class="o">=</span> <span class="n">_load_table</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">quiet</span><span class="p">)</span>
    <span class="n">HectorSim_args</span> <span class="o">=</span> <span class="nb">vars</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>


    <span class="n">full_catalogue_table</span><span class="p">[</span><span class="s1">&#39;PRI_SAMI&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">8</span>
    <span class="n">full_catalogue_table</span><span class="p">[</span><span class="s1">&#39;remaining_observations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">low_mass_galaxies_for_repeats</span> <span class="o">=</span> <span class="p">(</span><span class="n">full_catalogue_table</span><span class="p">[</span><span class="s1">&#39;Mstar&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">9</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">full_catalogue_table</span><span class="p">[</span><span class="s1">&#39;Mstar&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">full_catalogue_table</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">low_mass_galaxies_for_repeats</span><span class="p">,</span> <span class="s1">&#39;remaining_observations&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>


    <span class="n">HectorSim_args</span><span class="p">[</span><span class="s1">&#39;entire_table&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">full_catalogue_table</span>

    <span class="n">HS</span> <span class="o">=</span> <span class="n">HectorSim</span><span class="p">(</span><span class="o">**</span><span class="n">HectorSim_args</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">18.87</span><span class="p">,</span> <span class="mf">5.94</span><span class="p">))</span>
    <span class="n">HS</span><span class="o">.</span><span class="n">make_Julias_plot</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">hspace</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.28</span><span class="p">)</span>

    <span class="n">fig_skyplot</span><span class="p">,</span> <span class="n">ax_skyplot</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">18.87</span><span class="p">,</span> <span class="mf">5.94</span><span class="p">))</span>
    <span class="n">ax_skyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">RA</span><span class="p">,</span> <span class="n">HS</span><span class="o">.</span><span class="n">entire_table</span><span class="o">.</span><span class="n">DEC</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Entire Input Catalogue&#39;</span><span class="p">)</span>
    <span class="n">ax_skyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">RA</span><span class="p">,</span> <span class="n">HS</span><span class="o">.</span><span class="n">possible_to_observe</span><span class="o">.</span><span class="n">DEC</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Possible to observe (e.g. big/bright enough)&#39;</span><span class="p">)</span>
    <span class="n">ax_skyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">RA</span><span class="p">,</span> <span class="n">HS</span><span class="o">.</span><span class="n">selection_function</span><span class="o">.</span><span class="n">DEC</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Above selection function&#39;</span><span class="p">)</span>
    <span class="n">ax_skyplot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">RA</span><span class="p">,</span> <span class="n">HS</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">DEC</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Final catalogue (sparse sampling)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="c1">#plt.savefig(&#39;53pc_below_0p6.png&#39;)</span>
    <span class="c1">#P.save_dataframe_as_FITS_table(HS.selection_function_sparsely_sampled, &#39;/Users/samvaughan/Science/Hector/Tiling/TestingInputCatalogues/Tables/test_GAMA_Hector_Input_catalogue_53pc_below_0p6.fits&#39;)</span>


    <span class="c1">## Work out the final source densities</span>
    <span class="n">N_galaxy_targets</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="p">)</span>
    <span class="n">N_hexabundles</span> <span class="o">=</span> <span class="mi">19</span>
    <span class="n">final_source_density</span> <span class="o">=</span> <span class="n">N_galaxy_targets</span> <span class="o">/</span> <span class="n">HS</span><span class="o">.</span><span class="n">total_area</span> <span class="c1"># Galaxies per square degree</span>
    <span class="n">source_density_per_Hector_field</span> <span class="o">=</span> <span class="n">final_source_density</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="mi">1</span> <span class="o">*</span> <span class="mi">1</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">selection_function</span><span class="p">)</span><span class="si">}</span><span class="s2"> galaxies satisfy the selection function&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Final Catalogue contains </span><span class="si">{</span><span class="n">N_galaxy_targets</span><span class="si">}</span><span class="s2"> galaxies&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Source Density above selection function (blue points): </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">selection_function</span><span class="p">)</span><span class="o">/</span><span class="n">HS</span><span class="o">.</span><span class="n">total_area</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> galaxies per 2DF field&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Source Density in final catalogue (magenta points): </span><span class="si">{</span><span class="n">source_density_per_Hector_field</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2"> galaxies per 2DF field&quot;</span><span class="p">)</span>
    
    <span class="c1">## Print the fraction of galaxies below z=0.06</span>
    <span class="n">fraction_below_0p6</span> <span class="o">=</span> <span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="o">.</span><span class="n">z</span> <span class="o">&lt;</span> <span class="mf">0.06</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">HS</span><span class="o">.</span><span class="n">selection_function_sparsely_sampled</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fraction of galaixes below z=0.06: </span><span class="si">{</span><span class="n">fraction_below_0p6</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    


    <span class="c1"># fig, ax = plt.subplots()</span>
    <span class="c1"># HS.plot_parent_sample(fig, ax)</span>



</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2022, Sam Vaughan.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 5.0.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>